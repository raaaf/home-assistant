# Lighting - Motion Sensors.Yaml
# Generated by automation splitter - 1 automations
# Part of Home Assistant configuration

- id: '1729085669914'
  alias: Helper » Outside Illumination - Motion
  description: 'Steuert Bewegungsmelder basierend auf Außenbeleuchtung (Sonne + Helligkeitssensor).

    '
  triggers:
  - entity_id: sensor.sunlight_pct
    above: 20
    trigger: numeric_state
  - entity_id: sensor.sunlight_pct
    below: 15
    trigger: numeric_state
  # Balcony illuminance triggers disabled - using sunlight percentage instead
  # - entity_id:
  #   - sensor.balkon_motion_illuminance
  #   above: 450
  #   trigger: numeric_state
  #   enabled: false
  #   for:
  #     hours: 0
  #     minutes: 1
  #     seconds: 0
  # - entity_id:
  #   - sensor.balkon_motion_illuminance
  #   below: 400
  #   trigger: numeric_state
  #   enabled: false
  #   for:
  #     hours: 0
  #     minutes: 1
  #     seconds: 0
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: or
        conditions:
        - condition: and
          conditions:
          - condition: numeric_state
            entity_id: sensor.sunlight_pct
            above: 20
          - condition: template
            value_template: "{{ has_value('sensor.sunlight_pct') }}"
        # Balcony illuminance condition disabled
        # - condition: and
        #   conditions:
        #   - condition: numeric_state
        #     entity_id: sensor.balkon_motion_illuminance
        #     above: 450
        #   - condition: template
        #     value_template: "{{ has_value('sensor.balkon_motion_illuminance') }}"
      sequence:
      - data:
          stop_actions: true
        target:
          entity_id:
          - automation.1672929418223  # Kitchen motion sensor
          - automation.motion_balkon  # Balcony motion sensor
          - automation.1745924154398  # Bathroom motion sensor
          - automation.motion_flur_wohnung  # Hallway motion sensor
          - automation.1672931243226  # Living room motion sensor
          - automation.arbeitszimmer_motion  # Office motion sensor
          - automation.1692710690350  # Additional motion sensor
          - automation.1678724233791  # Bedroom motion sensor
        action: automation.turn_off
      - target:
          entity_id:
          - light.aqara_hub_lightbulb
          - light.lichterkette
          - light.alle_arbeitszimmer_lichter
          - light.alle_arbeitszimmer_nachtlichter
          - light.alle_badezimmer_lichter
          - light.alle_badezimmer_nachtlichter
          - light.alle_balkon_lichter
          - light.alle_flur_lichter
          - light.alle_flur_nachtlichter
          - light.alle_kinderzimmer_lichter
          - light.alle_kinderzimmer_nachtlichter
          - light.alle_kuche_lichter
          - light.alle_kuche_nachtlichter
          - light.alle_schlafzimmer_lichter
          - light.alle_schlafzimmer_nachtlichter
          - light.alle_wohnzimmer_lichter
          - light.alle_wohnzimmer_nachtlichter
        action: light.turn_off
        data: {}
    - conditions:
      - condition: or
        conditions:
        - condition: and
          conditions:
          - condition: numeric_state
            entity_id: sensor.sunlight_pct
            below: 15
          - condition: template
            value_template: "{{ has_value('sensor.sunlight_pct') }}"
        # Balcony illuminance condition disabled
        # - condition: and
        #   conditions:
        #   - condition: numeric_state
        #     entity_id: sensor.balkon_motion_illuminance
        #     below: 400
        #   - condition: template
        #     value_template: "{{ has_value('sensor.balkon_motion_illuminance') }}"
      sequence:
      - target:
          entity_id:
          - automation.1672929418223  # Kitchen motion sensor
          - automation.motion_balkon  # Balcony motion sensor
          - automation.1745924154398  # Bathroom motion sensor
          - automation.motion_flur_wohnung  # Hallway motion sensor
          - automation.1672931243226  # Living room motion sensor
          - automation.arbeitszimmer_motion  # Office motion sensor
          - automation.1692710690350  # Additional motion sensor
          - automation.1678724233791  # Bedroom motion sensor
        action: automation.turn_on
        data: {}
  mode: restart
  max_exceeded: silent
