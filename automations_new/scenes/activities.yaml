# Scenes - Activities.Yaml
# Generated by automation splitter - 3 automations
# Part of Home Assistant configuration

- id: '1722519061740'
  alias: Scenen » Gäste
  description: Deaktiviert bestimmte Automationen im Gästemodus für mehr Privatsphäre
  triggers:
  - entity_id: input_boolean.guest_or_away
    to: 'on'
    for:
      minutes: 1
    id: gäste-an
    trigger: state
  - entity_id: input_boolean.guest_or_away
    to: 'off'
    for:
      minutes: 1
    id: gäste-aus
    trigger: state
  - event_type: timer.finished
    event_data:
      entity_id: timer.lock_door_after_guest
    id: timer-abgelaufen
    trigger: event
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: gäste-an
      sequence:
      - data:
          stop_actions: true
        target:
          entity_id:
          - automation.1696241451967  # Helper » Workday Musik - Automatic workday music
        action: automation.turn_off
      - target:
          entity_id:
          - switch.wohnzimmer_steckdose
          - switch.kuchengerate
        action: switch.turn_on
    - conditions:
      - condition: trigger
        id: gäste-aus
      sequence:
      - target:
          entity_id:
          - automation.1696241451967  # Helper » Workday Musik - Automatic workday music
        action: automation.turn_on
      - target:
          entity_id:
          - switch.wohnzimmer_steckdose
          - switch.kuchengerate
        action: switch.turn_off
    - conditions:
      - condition: trigger
        id: timer-abgelaufen
      - condition: state
        entity_id: lock.smart_lock_pro
        state: unlocked
      - condition: template
        value_template: "{{ has_value('lock.smart_lock_pro') }}"
      - condition: state
        entity_id: input_boolean.alle_sind_weg
        state: 'on'
      - condition: template
        value_template: "{{ has_value('input_boolean.alle_sind_weg') }}"
      sequence:
      - target:
          entity_id: lock.smart_lock_pro
        action: lock.lock
      - data:
          title: Tür automatisch verschlossen
          message: Die Tür wurde nach Ablauf des Timers automatisch verschlossen.
        action: notify.family
  mode: single
- id: '1737546608146'
  alias: Scenen » Party
  description: Aktiviert Party-Modus in allen Räumen mit dynamischer Beleuchtung und
    deaktivierten Bewegungsmeldern
  triggers:
  - entity_id:
    - input_boolean.party
    to: 'on'
    id: 'on'
    trigger: state
  - entity_id:
    - input_boolean.party
    to: 'off'
    id: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: 'on'
      sequence:
      - action: switch.turn_off
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
          - switch.adaptive_lighting_badezimmer
          - switch.adaptive_lighting_kinderzimmer
          - switch.adaptive_lighting_arbeitszimmer
          - switch.adaptive_lighting_flur
          - switch.adaptive_lighting_schlafzimmer
          - switch.adaptive_lighting_waschzimmer
          - switch.adaptive_lighting_balkon
      - action: light.turn_off
        data:
          transition: 5
        target:
          entity_id:
          - light.wohnzimmer_wand_alle
          - light.kuche_decke_alle
          - light.flur_decke_alle
          - light.schlafzimmer_decke_alle
          - light.ankleide_decke_alle
      - data:
          stop_actions: true
        target:
          entity_id:
          - automation.1672931243226  # Motion sensor automation (living room)
          - automation.motion_flur_wohnung  # Hallway motion sensor
          - automation.1678724233791  # Bedroom motion sensor  
          - automation.1672929418223  # Kitchen motion sensor
          - automation.1745924154398  # Bathroom motion sensor
          - automation.arbeitszimmer_motion  # Office motion sensor
          - automation.1692710690350  # Additional motion sensor
          - automation.motion_haustur  # Front door motion sensor
        action: automation.turn_off
      - action: scene_presets.start_dynamic_scene
        data:
          preset_id: 9565033d-f2ea-4821-bfba-7dd9b35be20a
          targets:
            entity_id:
            - light.alle_party_lichter
          transition: 45
          interval: 60
    - conditions:
      - condition: trigger
        id: 'off'
      sequence:
      - action: switch.turn_on
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
          - switch.adaptive_lighting_badezimmer
          - switch.adaptive_lighting_kinderzimmer
          - switch.adaptive_lighting_arbeitszimmer
          - switch.adaptive_lighting_flur
          - switch.adaptive_lighting_schlafzimmer
          - switch.adaptive_lighting_waschzimmer
          - switch.adaptive_lighting_balkon
      - data:
          stop_actions: true
        target:
          entity_id:
          - automation.1672931243226  # Motion sensor automation (living room)
          - automation.motion_flur_wohnung  # Hallway motion sensor
          - automation.1678724233791  # Bedroom motion sensor  
          - automation.1672929418223  # Kitchen motion sensor
          - automation.1745924154398  # Bathroom motion sensor
          - automation.arbeitszimmer_motion  # Office motion sensor
          - automation.1692710690350  # Additional motion sensor
          - automation.motion_haustur  # Front door motion sensor
        action: automation.turn_on
      - action: light.turn_off
        data:
          transition: 5
        target:
          entity_id:
          - light.alle_party_lichter
    default: []
  mode: single
- id: '1744448757845'
  alias: Szene » Arbeit
  description: 'Aktiviert spezielle Lichtszene und deaktiviert Bewegung bei aktivem
    Arbeitsmodus. Berücksichtigt auch Schlafenszeit für Beleuchtung.

    '
  triggers:
  - trigger: state
    entity_id: input_boolean.arbeit
    to: 'on'
    id: arbeit-on
  - trigger: state
    entity_id: input_boolean.arbeit
    to: 'off'
    id: arbeit-off
  conditions: []
  actions:
  - choose:
    - alias: Arbeitsmodus aktivieren
      conditions:
      - condition: trigger
        id: arbeit-on
      - condition: state
        entity_id: input_boolean.gaming
        state: 'off'
      sequence:
      - alias: Bewegungsmelder Schlafzimmer deaktivieren
        action: automation.turn_off
        target:
          entity_id: automation.1678724233791  # Bedroom motion sensor
        data:
          stop_actions: true
      - alias: Alle Arbeitslichter ausschalten
        action: light.turn_off
        target:
          entity_id:
          - light.alle_arbeitszimmer_nachtlichter
          - light.alle_arbeitszimmer_lichter
        data: {}
      - choose:
        - alias: Dunkel und vor 21 Uhr - normale Arbeitsbeleuchtung
          conditions:
          - alias: Es ist dunkel (Sonne unter oder Schlafenszeit)
            condition: template
            value_template: "{{ has_value('sun.sun') and (state_attr('sun.sun', 'elevation') < 0 or \n   (has_value('input_boolean.schlafenszeit') and is_state('input_boolean.schlafenszeit',\
              \ 'on'))) }}\n"
          - alias: Vor 21 Uhr
            condition: template
            value_template: '{{ now().hour < 21 }}'
          sequence:
          - alias: Helle Arbeitsbeleuchtung einschalten
            action: light.turn_on
            target:
              entity_id:
              - light.alle_arbeitszimmer_nachtlichter
              - light.alle_arbeitszimmer_lichter
            data:
              brightness_pct: 80
              kelvin: 5000
              transition: 2
        - alias: Dunkel und nach 21 Uhr - gedämpfte Arbeitsbeleuchtung
          conditions:
          - alias: Es ist dunkel (Sonne unter oder Schlafenszeit)
            condition: template
            value_template: "{{ has_value('sun.sun') and (state_attr('sun.sun', 'elevation') < 0 or \n   (has_value('input_boolean.schlafenszeit') and is_state('input_boolean.schlafenszeit',\
              \ 'on'))) }}\n"
          - alias: Nach 21 Uhr
            condition: template
            value_template: '{{ now().hour >= 21 }}'
          sequence:
          - alias: Gedämpfte Arbeitsbeleuchtung einschalten
            action: light.turn_on
            target:
              entity_id: light.alle_arbeitszimmer_nachtlichter
            data:
              brightness_pct: 60
              kelvin: 4000
              transition: 2
    - alias: Arbeitsmodus deaktivieren
      conditions:
      - condition: trigger
        id: arbeit-off
      - condition: state
        entity_id: input_boolean.gaming
        state: 'off'
      sequence:
      - alias: Bewegungsmelder Schlafzimmer aktivieren
        action: automation.turn_on
        target:
          entity_id: automation.1678724233791  # Bedroom motion sensor
        data: {}
      - alias: Nur ausschalten wenn es dunkel ist
        condition: template
        value_template: "{{ has_value('sun.sun') and (state_attr('sun.sun', 'elevation') < 0 or \n   (has_value('input_boolean.schlafenszeit') and is_state('input_boolean.schlafenszeit',\
          \ 'on'))) }}\n"
      - alias: Alle Arbeitslichter ausschalten
        action: light.turn_off
        target:
          entity_id:
          - light.alle_arbeitszimmer_nachtlichter
          - light.alle_arbeitszimmer_lichter
        data: {}
  mode: restart
