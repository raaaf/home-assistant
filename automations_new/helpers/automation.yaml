# Helpers - Automation.Yaml
# Generated by automation splitter - 5 automations
# Part of Home Assistant configuration

- id: '1696241451967'
  alias: Helper Â» Workday Musik
  description: 'Startet sanfte Musik zum Aufwachen an Werktagen. Nutzt alle HomePods
    (4 Minis + 2 OG) in einer Gruppe.

    '
  triggers:
  - at: sensor.wakeup_light_timestamp
    trigger: time
    id: wakeup-time
  conditions:
  - condition: state
    entity_id: input_boolean.alle_sind_weg
    state: 'off'
  - condition: template
    value_template: "{{ has_value('input_boolean.alle_sind_weg') }}"
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: template
    value_template: "{{ has_value('binary_sensor.workday_sensor') }}"
  - condition: time
    after: 05:00:00
    before: '10:00:00'
  actions:
  - action: media_player.volume_set
    data:
      volume_level: 0
    target:
      entity_id: media_player.homepods
  - wait_template: '{{ state_attr(''media_player.homepods'', ''volume_level'') | float(1)
      <= 0.01 }}'
    timeout: 00:00:05
    continue_on_timeout: true
  - action: input_boolean.turn_on
    target:
      entity_id:
      - input_boolean.werktag_aufwachen
      - input_boolean.werktag_musik
    data: {}
  - wait_template: '{{ is_state(''media_player.homepods'', ''playing'') }}'
    timeout: 00:00:15
    continue_on_timeout: true
  - delay: 00:00:03
  - if:
    - condition: template
      value_template: '{{ state_attr(''media_player.homepods'', ''volume_level'')
        | float(0) > 0.1 }}'
    then:
    - action: media_player.volume_set
      data:
        volume_level: 0.01
      target:
        entity_id: media_player.homepods
    - delay: 00:00:01
  - action: script.fade_volume
    data:
      curve: linear
      target_player: media_player.homepods
      duration: 600
      target_volume: 0.35
  - delay: 00:04:05
  - action: input_boolean.turn_off
    target:
      entity_id:
      - input_boolean.werktag_musik
      - input_boolean.werktag_aufwachen
    data: {}
  - action: notify.persistent_notification
    data:
      title: ðŸŽµ Guten Morgen!
      message: 'Wakeup Musik gestartet um {{ as_timestamp(states(''sensor.wakeup_light_timestamp''))
        | timestamp_custom(''%H:%M'') }}

        HomePods (6 GerÃ¤te): {{ (state_attr(''media_player.homepods'', ''volume_level'')
        | float(0) * 100) | round(0) }}% LÃ¤uft: {{ state_attr(''media_player.homepods'',
        ''media_title'') | default(''Apple Home Musik'') }}

        Fade: 4 Min mit Bezier-Kurve

        '
  mode: single
- id: '1727375741611'
  alias: Szenen Â» Lesen
  description: Aktiviert spezielle Lesebeleuchtung und deaktiviert Bewegungsmelder
  triggers:
  - entity_id:
    - input_boolean.lesen
    to: 'on'
    id: 'on'
    trigger: state
  - entity_id:
    - input_boolean.lesen
    to: 'off'
    id: 'off'
    trigger: state
  - entity_id:
    - input_boolean.lesen
    to: 'on'
    id: on-30
    for:
      hours: 1
      minutes: 0
      seconds: 0
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: 'on'
      sequence:
      - data: {}
        action: automation.turn_off
        target:
          entity_id: automation.1692710690350  # Additional motion sensor
      - action: scene_presets.start_dynamic_scene
        data:
          preset_id: 8f55e62a-e5f8-456a-9e8b-61f314bd4e99
          targets:
            entity_id: light.kinderzimmer_stehlampe
          shuffle: false
          smart_shuffle: false
    - conditions:
      - condition: trigger
        id: 'off'
      sequence:
      - data:
          transition: 3
        action: light.turn_off
        target:
          entity_id: light.kinderzimmer_stehlampe
      - data: {}
        action: automation.turn_on
        target:
          entity_id: automation.1692710690350  # Additional motion sensor
    - conditions:
      - condition: trigger
        id:
        - on-30
      sequence:
      - action: input_boolean.turn_off
        target:
          entity_id:
          - input_boolean.lesen
        data: {}
    default: []
  mode: single
- id: '1731339074618'
  alias: Henry Â» Fertigmachen-Ampel
  description: Steuert Ampel-Licht fÃ¼r morgendliche Routine (GrÃ¼n 6:00, Gelb 7:45,
    Rot 8:00)
  triggers:
  - trigger: time
    at: 06:00:00
    id: green
  - trigger: time
    at: 07:45:00
    id: yellow
  - trigger: time
    at: 08:00:00
    id: red
  - trigger: time
    at: 08:30:00
    id: 'off'
  conditions:
  - condition: state
    entity_id: input_boolean.alle_sind_weg
    state: 'off'
  - condition: template
    value_template: "{{ has_value('input_boolean.alle_sind_weg') }}"
  - condition: state
    entity_id: binary_sensor.workday_sensor
    state: 'on'
  - condition: template
    value_template: "{{ has_value('binary_sensor.workday_sensor') }}"
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id:
        - green
      - condition: state
        entity_id: binary_sensor.workday_sensor
        state: 'on'
      sequence:
      - action: light.turn_on
        data:
          rgb_color:
          - 0
          - 255
          - 42
          brightness_pct: 100
        target:
          entity_id: light.aqara_hub_lightbulb
    - conditions:
      - condition: trigger
        id:
        - yellow
      - condition: state
        entity_id: binary_sensor.workday_sensor
        state: 'on'
      sequence:
      - action: light.turn_on
        data:
          rgb_color:
          - 247
          - 206
          - 70
          brightness_pct: 100
          effect: breathe
        target:
          entity_id: light.aqara_hub_lightbulb
    - conditions:
      - condition: trigger
        id:
        - red
      - condition: state
        entity_id: binary_sensor.workday_sensor
        state: 'on'
      sequence:
      - action: light.turn_on
        data:
          rgb_color:
          - 255
          - 0
          - 0
          brightness_pct: 100
        target:
          entity_id: light.aqara_hub_lightbulb
    - conditions:
      - condition: trigger
        id:
        - 'off'
      sequence:
      - action: light.turn_off
        target:
          entity_id: light.aqara_hub_lightbulb
  mode: single
