# Appliances - Laundry.Yaml
# Generated by automation splitter - 4 automations
# Part of Home Assistant configuration

- id: '1661933181865'
  alias: Notifications Â» Waschmaschine
  description: Ãœberwacht den Waschmaschinen-Status via Stromverbrauch und sendet Benachrichtigungen
  triggers:
  - above: 10
    entity_id:
    - sensor.steckdose_waschmaschine_power
    for:
      hours: 0
      minutes: 0
      seconds: 5
    id: arbeitet
    trigger: numeric_state
  - entity_id:
    - sensor.steckdose_waschmaschine_power
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: fertig
    below: 7
    above: 1.1
    trigger: numeric_state
  - entity_id:
    - sensor.steckdose_waschmaschine_power
    for:
      hours: 0
      minutes: 5
      seconds: 0
    id: aus
    below: 1
    trigger: numeric_state
  conditions:
  - condition: template
    value_template: " {% set last = state_attr('automation.waschmaschine_arbeitet',\
      \ 'last_triggered') %}\n    {{ last is none or (now() - last).total_seconds()\
      \ > 12 * 60 }}"
    enabled: false
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: arbeitet
      sequence:
      - data:
          option: Arbeitet
        target:
          entity_id: input_select.waschmaschine
        action: input_select.select_option
    - conditions:
      - condition: trigger
        id: fertig
      - condition: state
        entity_id: input_select.waschmaschine
        state: Arbeitet
      sequence:
      - data:
          option: Fertig
        target:
          entity_id: input_select.waschmaschine
        action: input_select.select_option
      - if:
        - condition: state
          entity_id: person.rafael
          state: home
        then:
        - data:
            title: Waschmaschine ist fertig
            message: ({{ now().strftime('%H:%M Uhr, %d.%m.%Y') }})
            data:
              push:
                interruption-level: critical
          action: notify.rafael
      - if:
        - condition: state
          entity_id: person.alex
          state: home
        then:
        - data:
            title: Waschmaschine ist fertig
            message: ({{ now().strftime('%H:%M Uhr, %d.%m.%Y') }})
            data:
              push:
                interruption-level: critical
          action: notify.alex
    - conditions:
      - condition: trigger
        id: aus
      sequence:
      - data:
          option: Aus
        target:
          entity_id: input_select.waschmaschine
        action: input_select.select_option
    default: []
- id: '1661934852025'
  alias: Notifications Â» Trockner
  description: Ãœberwacht den Trockner-Status via Stromverbrauch und sendet Benachrichtigungen
  triggers:
  - entity_id: sensor.trockner_current_consumption
    above: 10
    for:
      seconds: 30
    id: arbeitet
    trigger: numeric_state
  - entity_id: sensor.trockner_current_consumption
    above: 1.3
    below: 7
    for:
      minutes: 1
      seconds: 30
    id: fertig
    trigger: numeric_state
  - entity_id: sensor.trockner_current_consumption
    below: 1.2
    for:
      minutes: 5
    id: aus
    trigger: numeric_state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: arbeitet
      sequence:
      - target:
          entity_id: input_select.trockner
        data:
          option: Arbeitet
        action: input_select.select_option
    - conditions:
      - condition: trigger
        id: fertig
      - condition: state
        entity_id: input_select.trockner
        state: Arbeitet
      sequence:
      - target:
          entity_id: input_select.trockner
        data:
          option: Fertig
        action: input_select.select_option
      - data:
          notification_id: trockner_fertig
          title: ðŸ§º Trockner ist fertig
          message: Der Trockner wurde um {{ now().strftime('%H:%M Uhr') }} fertig.
        action: persistent_notification.create
      - parallel:
        - if:
          - condition: state
            entity_id: person.rafael
            state: home
          then:
          - data:
              title: ðŸ§º Trockner ist fertig
              message: Der Trockner ist fertig! ({{ now().strftime('%H:%M Uhr') }})
              data:
                push:
                  interruption-level: critical
            action: notify.rafael
        - if:
          - condition: state
            entity_id: person.alex
            state: home
          then:
          - data:
              title: ðŸ§º Trockner ist fertig
              message: Der Trockner ist fertig! ({{ now().strftime('%H:%M Uhr') }})
              data:
                push:
                  interruption-level: critical
            action: notify.alex
    - conditions:
      - condition: trigger
        id: aus
      sequence:
      - target:
          entity_id: input_select.trockner
        data:
          option: Aus
        action: input_select.select_option
      - data:
          notification_id: trockner_fertig
        action: persistent_notification.dismiss
  mode: single
  max_exceeded: silent
- id: '1682954529440'
  alias: Helper Â» Waschmaschine ist fertig
  description: Verwaltet Status-Flags und Stromversorgung der Waschmaschine
  triggers:
  - entity_id:
    - input_select.waschmaschine
    from: Arbeitet
    to: Fertig
    for:
      hours: 0
      minutes: 1
      seconds: 30
    id: fertig
    trigger: state
  - entity_id:
    - input_select.waschmaschine
    from: Fertig
    to: Aus
    for:
      hours: 0
      minutes: 0
      seconds: 30
    id: aus
    trigger: state
  - entity_id:
    - input_select.waschmaschine
    to: Aus
    for:
      hours: 0
      minutes: 30
      seconds: 0
    id: ausschlaten
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: fertig
      sequence:
      - data: {}
        target:
          entity_id: input_boolean.waschmaschine_ist_fertig
        action: input_boolean.turn_on
    - conditions:
      - condition: trigger
        id: aus
      sequence:
      - data: {}
        target:
          entity_id: input_boolean.waschmaschine_ist_fertig
        action: input_boolean.turn_off
    - conditions:
      - condition: trigger
        id:
        - ausschlaten
      sequence:
      - action: switch.turn_off
        target:
          entity_id: switch.steckdose_waschmaschine
  mode: single
- id: '1682954554027'
  alias: Helper Â» Trockner ist fertig
  description: Verwaltet Status-Flags und Stromversorgung des Trockners
  triggers:
  - entity_id: input_select.trockner
    from: Arbeitet
    to: Fertig
    for:
      seconds: 30
    id: fertig
    trigger: state
  - entity_id: input_select.trockner
    from: Fertig
    to: Aus
    for:
      seconds: 30
    id: aus
    trigger: state
  - entity_id: input_select.trockner
    to: Aus
    for:
      minutes: 30
    id: ausschalten
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: fertig
      sequence:
      - target:
          entity_id: input_boolean.trockner_ist_fertig
        action: input_boolean.turn_on
    - conditions:
      - condition: trigger
        id: aus
      sequence:
      - target:
          entity_id: input_boolean.trockner_ist_fertig
        action: input_boolean.turn_off
    - conditions:
      - condition: trigger
        id: ausschalten
      sequence:
      - target:
          entity_id: switch.trockner
        action: switch.turn_off
  mode: single
  max_exceeded: silent
