# Areas - Arbeitszimmer.Yaml
# Generated by automation splitter - 3 automations
# Part of Home Assistant configuration

- id: '1642078171716'
  alias: Arbeitszimmer » Zustandserkennung
  description: 'Erkennt anhand von Geräten, ob gearbeitet oder gespielt wird, und
    setzt den entsprechenden Zustand. Steuert auch die Beleuchtung direkt.

    '
  triggers:
  - trigger: state
    entity_id: binary_sensor.macbook_air_von_alexandra_active
    to: 'on'
    id: work-alex-on
  - trigger: state
    entity_id: binary_sensor.macbook_pro_rafael_active
    to: 'on'
    id: work-rafael-on
  - trigger: state
    entity_id: binary_sensor.macbook_air_von_alexandra_active
    to: 'off'
    id: work-alex-off
  - trigger: state
    entity_id: binary_sensor.macbook_pro_rafael_active
    to: 'off'
    id: work-rafael-off
  - trigger: state
    entity_id: device_tracker.gamingpc
    to: home
    id: gaming-on
  - trigger: state
    entity_id: device_tracker.gamingpc
    from: home
    to:
    - unavailable
    - not_home
    - unknown
    id: gaming-off
  condition: []
  action:
  - choose:
    - alias: Arbeit einschalten
      conditions:
      - condition: or
        conditions:
        - alias: Alexandra arbeitet am Studio Display
          condition: and
          conditions:
          - condition: trigger
            id: work-alex-on
          - condition: state
            entity_id: sensor.macbook_air_von_alexandra_primary_display_name
            state: Studio Display
        - alias: Rafael arbeitet am Studio Display
          condition: and
          conditions:
          - condition: trigger
            id: work-rafael-on
          - condition: state
            entity_id: sensor.macbook_pro_rafael_primary_display_name
            state: Studio Display
      sequence:
      - action: input_boolean.turn_on
        target:
          entity_id: input_boolean.arbeit
        data: {}
      - delay:
          seconds: 0.5
      - action: light.turn_on
        target:
          entity_id: light.alle_arbeitszimmer_nachtlichter
        data:
          brightness_pct: 50
          transition: 2
    - alias: Arbeit ausschalten
      conditions:
      - condition: and
        conditions:
        - alias: Ausschalt-Trigger empfangen
          condition: or
          conditions:
          - condition: trigger
            id: work-alex-off
          - condition: trigger
            id: work-rafael-off
          - condition: trigger
            id: gaming-off
        - alias: Alle Arbeits- und Gaming-Geräte sind aus
          condition: template
          value_template: "{{ states('input_boolean.gaming') not in ['unknown', 'unavailable'] and states('input_boolean.gaming') == 'off' and\n   states('binary_sensor.macbook_air_von_alexandra_active') not in ['unknown', 'unavailable'] and states('binary_sensor.macbook_air_von_alexandra_active')\
            \ == 'off' and\n   states('binary_sensor.macbook_pro_rafael_active') not in ['unknown', 'unavailable'] and states('binary_sensor.macbook_pro_rafael_active') ==\
            \ 'off' }}\n"
      sequence:
      - action: input_boolean.turn_off
        target:
          entity_id: input_boolean.arbeit
        data: {}
      - condition: state
        entity_id: input_boolean.gaming
        state: 'off'
      - action: switch.turn_on
        target:
          entity_id: switch.adaptive_lighting_arbeitszimmer
        data: {}
    - alias: Gaming einschalten
      conditions:
      - condition: trigger
        id: gaming-on
      sequence:
      - action: input_boolean.turn_on
        target:
          entity_id: input_boolean.gaming
        data: {}
      - action: switch.turn_off
        target:
          entity_id: switch.adaptive_lighting_arbeitszimmer
        data: {}
      - delay:
          seconds: 0.5
      - action: light.turn_on
        target:
          entity_id: light.alle_arbeitszimmer_nachtlichter
        data:
          brightness_pct: 50
          rgb_color:
          - 255
          - 0
          - 255
          transition: 2
    - alias: Gaming ausschalten
      conditions:
      - condition: trigger
        id: gaming-off
      sequence:
      - action: input_boolean.turn_off
        target:
          entity_id: input_boolean.gaming
        data: {}
      - choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.arbeit
            state: 'on'
          sequence:
          - action: light.turn_on
            target:
              entity_id: light.alle_arbeitszimmer_nachtlichter
            data:
              brightness_pct: 50
              kelvin: 4000
              transition: 2
        default:
        - action: switch.turn_on
          target:
            entity_id: switch.adaptive_lighting_arbeitszimmer
          data: {}
  mode: single
- id: '1730279567232'
  alias: Motion » Arbeitszimmer
  description: Bewegungsgesteuerte Beleuchtung im Arbeitszimmer mit Nachtlicht-Modus
    und Anwesenheitserkennung
  use_blueprint:
    path: Blackshome/sensor-light.yaml
    input:
      motion_trigger:
      - binary_sensor.schlafzimmer_motion_occupancy
      light_switch:
        entity_id: light.alle_arbeitszimmer_lichter
      include_night_lights: night_lights_enabled
      night_lights:
        entity_id: light.alle_arbeitszimmer_nachtlichter
      night_lights_conditions:
      - entity_state_enabled
      night_lights_entity_state:
      - input_boolean.schlafenszeit
      include_sun: sun_disabled
      time_delay: 0
      include_device_tracker: zone_enabled
      zone: zone.home
      night_time_delay: 0
      include_night_light_control:
      - if_lights_are_on_adjust_when_crossing_over
      night_lights_after_time: '19:00:00'
      night_lights_before_time: 07:00:00
      include_ambient: ambient_enabled
      ambient_light_sensor: sensor.balkon_motion_illuminance_safe
      ambient_light_value: 150
      ambient_light_high_value: 200
      include_bypass:
      - bypass_enabled_turn_on
      motion_bypass_lights_on:
      - input_boolean.arbeit
      - input_boolean.gaming
