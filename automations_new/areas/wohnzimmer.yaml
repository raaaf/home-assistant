# Areas - Wohnzimmer.Yaml
# Generated by automation splitter - 7 automations
# Part of Home Assistant configuration

- id: '1642114646798'
  alias: Wohnzimmer » Film
  description: Aktiviert Kinomodus mit Ambilight wenn Medien abgespielt werden
  trigger:
  - entity_id:
    - media_player.denon_avr_x3200w
    to: 'off'
    for:
      seconds: 20
    id: 'off'
    from: 'on'
    trigger: state
  - entity_id: media_player.wohnzimmer
    from:
    - 'off'
    - idle
    - standby
    - paused
    to: playing
    for:
      seconds: 5
    id: 'on'
    trigger: state
  - entity_id:
    - media_player.denon_avr_x3200w
    attribute: source
    to: Game
    id: game-on
    trigger: state
  - entity_id:
    - media_player.wohnzimmer
    from: playing
    to: paused
    for:
      hours: 0
      minutes: 0
      seconds: 15
    id: paused
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: 'on'
      sequence:
      - metadata: {}
        data: {}
        target:
          entity_id: input_boolean.movie
        action: input_boolean.turn_on
      - action: adaptive_lighting.change_switch_settings
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
        data:
          max_brightness: 40
          min_brightness: 5
      - alias: "Deaktiviere Motion-Automationen"
        action: script.scene_disable_motion_automations
        data:
          automations: "automation.motion_kuche_2,automation.motion_esstisch"
      - target:
          entity_id: light.hyperhdr
        data:
          effect: USB Capture
          brightness_pct: 60
        action: light.turn_on
      - action: light.turn_off
        data:
          transition: 6
        target:
          entity_id:
          - light.alle_wohnzimmer_nachtlichter
      - alias: "Turn off living room lights (conditionally skip dining table)"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.essen
            state: 'off'
          sequence:
          - action: light.turn_off
            data:
              transition: 6
            target:
              entity_id: light.alle_wohnzimmer_lichter
        default:
        - action: light.turn_off
          data:
            transition: 6
          target:
            entity_id:
            - light.wohnzimmer_wand_alle
            - light.wohnzimmer_spielematte_alle
            - light.wohnzimmer_schrank_alle
            - light.wohnzimmer_spieletisch
      - alias: "Turn off kitchen lights if not cooking"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.kochen
            state: 'off'
          sequence:
          - action: light.turn_off
            data:
              transition: 6
            target:
              entity_id: light.alle_kuche_lichter
      - if:
        - condition: state
          entity_id: input_boolean.kochen
          state: 'off'
        then:
        - action: light.turn_off
          data:
            transition: 6
          target:
            entity_id: light.alle_flur_lichter
    - conditions:
      - condition: trigger
        id: 'off'
      sequence:
      - target:
          entity_id: input_boolean.movie
        data: {}
        action: input_boolean.turn_off
      - alias: "Setze aktive Szene zurück"
        action: input_select.select_option
        target:
          entity_id: input_select.active_scene
        data:
          option: "Keine"
      - action: adaptive_lighting.change_switch_settings
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
        data:
          max_brightness: 100
          min_brightness: 10
      - alias: "Reaktiviere Motion-Automationen mit Konflikt-Prüfung"
        action: script.scene_enable_motion_automations
        data:
          automations: "automation.motion_kuche_2"
          exclude_scenes: "kochen,party,party_wohnzimmer"
      - alias: "Reaktiviere Esstisch-Motion mit Konflikt-Prüfung"
        action: script.scene_enable_motion_automations
        data:
          automations: "automation.motion_esstisch"
          exclude_scenes: "essen"
      - target:
          entity_id:
          - light.hyperhdr
          - light.alle_kuche_nachtlichter
        data: {}
        action: light.turn_off
    - conditions:
      - condition: trigger
        id: paused
      sequence:
      - action: adaptive_lighting.change_switch_settings
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
        data:
          max_brightness: 80
          min_brightness: 10
      - target:
          entity_id: light.hyperhdr
        data:
          effect: Cinema dim lights
        action: light.turn_on
      - if:
        - condition: sun
          after: sunset
          before: sunrise
        then:
        - data:
            brightness_step_pct: 10
          target:
            entity_id:
            - light.alle_kuche_nachtlichter
            - light.alle_wohnzimmer_nachtlichter
          action: light.turn_on
      - alias: "Reaktiviere Motion-Automationen mit Konflikt-Prüfung"
        action: script.scene_enable_motion_automations
        data:
          automations: "automation.motion_kuche_2"
          exclude_scenes: "kochen,party,party_wohnzimmer"
      - alias: "Reaktiviere Esstisch-Motion mit Konflikt-Prüfung"
        action: script.scene_enable_motion_automations
        data:
          automations: "automation.motion_esstisch"
          exclude_scenes: "essen"
    - conditions:
      - condition: trigger
        id: game-on
      sequence:
      - target:
          entity_id: input_boolean.movie
        data: {}
        action: input_boolean.turn_on
      - action: adaptive_lighting.change_switch_settings
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
        data:
          max_brightness: 40
          min_brightness: 5
      - alias: "Deaktiviere Motion-Automationen"
        action: script.scene_disable_motion_automations
        data:
          automations: "automation.motion_kuche_2,automation.motion_esstisch"
      - target:
          entity_id: light.hyperhdr
        data:
          effect: USB Capture
        action: light.turn_on
      - target:
          entity_id:
          - light.alle_kuche_nachtlichter
          - light.alle_wohnzimmer_lichter
          - light.alle_wohnzimmer_nachtlichter
        data: {}
        action: light.turn_off
  mode: restart
- id: '1671133998236'
  alias: Wohnzimmer » Weihnachtsbaum
  description: Steuert Weihnachtsbaum-Beleuchtung mit erweiterten Features
  trigger:
  - event: sunset
    offset: -00:30:00
    id: sunset
    trigger: sun
  - at: 00:00:00
    id: midnight
    trigger: time
  - at: '22:00:00'
    id: dim_lights
    trigger: time
  - entity_id: input_boolean.alle_sind_weg
    from: 'on'
    to: 'off'
    id: coming_home
    trigger: state
  conditions:
  - condition: template
    value_template: >-
      {% set today = now().strftime('%m-%d') %}
      {% set start = '11-24' %}
      {% set end = '01-06' %}
      {{ (today >= start) or (today <= end) }}
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: sunset
      - condition: state
        entity_id: input_boolean.alle_sind_weg
        state: 'off'
      sequence:
      - if:
        - condition: template
          value_template: "{{ has_value('light.weihnachtsbaum') }}"
        then:
        - target:
            entity_id: light.weihnachtsbaum
          data:
            brightness_pct: "{% if now().hour >= 22 %}\n  {{ brightness_late }}\n{%\
              \ else %}\n  {{ brightness_normal }}\n{% endif %}\n"
            effect: '{{ effect_name }}'
            transition: 3
          action: light.turn_on
      - if:
        - condition: template
          value_template: "{{ has_value('switch.steckdose_avr') }}"
        then:
        - target:
            entity_id: switch.steckdose_avr
          action: switch.turn_on
    - conditions:
      - condition: trigger
        id: dim_lights
      - condition: state
        entity_id: light.weihnachtsbaum
        state: 'on'
      sequence:
      - if:
        - condition: template
          value_template: "{{ has_value('light.weihnachtsbaum') }}"
        then:
        - target:
            entity_id: light.weihnachtsbaum
          data:
            brightness_pct: '{{ brightness_late }}'
            transition: 10
          action: light.turn_on
      - if:
        - condition: template
          value_template: "{{ has_value('switch.steckdose_avr') }}"
        then:
        - target:
            entity_id: switch.steckdose_avr
          action: switch.turn_off
    - conditions:
      - condition: trigger
        id: coming_home
      - condition: sun
        after: sunset
      - condition: time
        before: 00:00:00
      sequence:
      - if:
        - condition: template
          value_template: "{{ has_value('light.weihnachtsbaum') }}"
        then:
        - target:
            entity_id: light.weihnachtsbaum
          data:
            brightness_pct: "{% if now().hour >= 22 %}\n  {{ brightness_late }}\n{%\
              \ else %}\n  {{ brightness_normal }}\n{% endif %}\n"
            effect: '{{ effect_name }}'
            transition: 3
          action: light.turn_on
      - if:
        - condition: template
          value_template: "{{ has_value('switch.steckdose_avr') and now().hour < 22 }}"
        then:
        - target:
            entity_id: switch.steckdose_avr
          action: switch.turn_on
    - conditions:
      - condition: trigger
        id: midnight
      sequence:
      - if:
        - condition: template
          value_template: "{{ has_value('light.weihnachtsbaum') }}"
        then:
        - target:
            entity_id: light.weihnachtsbaum
          data:
            transition: 5
          action: light.turn_off
      - if:
        - condition: template
          value_template: "{{ has_value('switch.steckdose_avr') }}"
        then:
        - target:
            entity_id: switch.steckdose_avr
          action: switch.turn_off
  mode: single
  max_exceeded: silent
  variables:
    turn_off_time_hour: 0
    turn_off_time_minute: 0
    sunset_offset: -00:30:00
    brightness_normal: 50
    brightness_late: 30
    effect_name: 4 Peachy
    start_date: 11-24
    end_date: 01-06
- id: '1737546250763'
  alias: Scenen » Party Wohnzimmer
  description: Aktiviert Party-Modus im Wohnzimmer mit dynamischer Beleuchtung und
    deaktivierten Bewegungsmeldern
  trigger:
  - entity_id:
    - input_boolean.party_wohnzimmer
    to: 'on'
    id: 'on'
    trigger: state
  - entity_id:
    - input_boolean.party_wohnzimmer
    to: 'off'
    id: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: 'on'
      sequence:
      - action: switch.turn_off
        metadata: {}
        data: {}
        target:
          entity_id:
          - switch.adaptive_lighting_wohnzimmer
          - switch.adaptive_lighting_kueche
      - delay:
          seconds: 0.5
      - action: light.turn_off
        metadata: {}
        data: {}
        target:
          entity_id:
          - light.wohnzimmer_wand_alle
          - light.kuche_decke_alle
          - light.steckdose_kuechengeraete
      - action: automation.turn_off
        target:
          entity_id:
          - automation.motion_kuche_2
          - automation.motion_flur_wohnung
        enabled: true
        data: {}
      - action: scene_presets.start_dynamic_scene
        metadata: {}
        data:
          preset_id: de7eda64-84bf-4ed6-a4fa-76e0ebdd1968
          targets:
            entity_id:
            - light.alle_wohnzimmer_lichter
          transition: 45
          interval: 60
    - conditions:
      - condition: trigger
        id: 'off'
      sequence:
      - alias: "Re-enable living room adaptive lighting if movie/party off"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.movie
            state: 'off'
          - condition: state
            entity_id: input_boolean.party
            state: 'off'
          sequence:
          - action: switch.turn_on
            target:
              entity_id: switch.adaptive_lighting_wohnzimmer
      - alias: "Re-enable kitchen adaptive lighting if movie/kochen/party off"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.movie
            state: 'off'
          - condition: state
            entity_id: input_boolean.kochen
            state: 'off'
          - condition: state
            entity_id: input_boolean.party
            state: 'off'
          sequence:
          - action: switch.turn_on
            target:
              entity_id: switch.adaptive_lighting_kueche
      - alias: "Re-enable kitchen motion only if no conflicting scenes are active"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.movie
            state: 'off'
          - condition: state
            entity_id: input_boolean.kochen
            state: 'off'
          - condition: state
            entity_id: input_boolean.party
            state: 'off'
          sequence:
          - action: automation.turn_on
            target:
              entity_id: automation.motion_kuche_2
      - alias: "Re-enable hallway motion only if no conflicting scenes are active"
        choose:
        - conditions:
          - condition: state
            entity_id: input_boolean.movie
            state: 'off'
          - condition: state
            entity_id: input_boolean.party
            state: 'off'
          sequence:
          - action: automation.turn_on
            target:
              entity_id: automation.motion_flur_wohnung
      - action: light.turn_off
        metadata: {}
        data:
          transition: 5
        target:
          entity_id:
          - light.alle_wohnzimmer_lichter
      - action: scene_presets.stop_dynamic_scene
        metadata: {}
        data:
          id: de7eda64-84bf-4ed6-a4fa-76e0ebdd1968
    default: []
  mode: restart
- id: '1744714272996'
  alias: Scenen » Esstisch reinigen
  description: 'Helles Licht zum Reinigen des Esstisch Bereichs'
  trigger:
  - entity_id:
    - input_boolean.esstisch
    to: 'on'
    id: 'on'
    trigger: state
  - entity_id:
    - input_boolean.esstisch
    to: 'off'
    id: 'off'
    trigger: state
  conditions: []
  actions:
  - choose:
    - conditions:
      - condition: trigger
        id: 'on'
      sequence:
      - action: vacuum.send_command
        data:
          command: app_zoned_clean
          params:
          - - 24638
            - 26629
            - 27433
            - 30765
            - 1
        target:
          entity_id: vacuum.robbi_2
      - action: input_boolean.turn_off
        metadata: {}
        data: {}
        target:
          entity_id: input_boolean.esstisch
    - conditions:
      - condition: trigger
        id: 'off'
      sequence:
      - data: {}
        target:
          entity_id: input_boolean.essen
        action: input_boolean.turn_off
  mode: single
- id: '1745924154398'
  alias: Motion » Esstisch
  description: Bewegungsgesteuerte Beleuchtung im Esszimmer mit Nachtlicht-Modus und
    Kochmodus-Bypass
  use_blueprint:
    path: Blackshome/sensor-light.yaml
    input:
      motion_trigger:
      - binary_sensor.motion_esstisch
      - binary_sensor.wohnzimmer_vibration_vibration
      - binary_sensor.wohnzimmer_vibration_2_vibration
      light_switch:
        entity_id: light.wohnzimmer_esstisch_alle
      include_night_lights: night_lights_disabled
      night_lights:
        entity_id: light.alle_kuche_nachtlichter
      night_lights_after_time: '22:00:00'
      night_lights_before_time: 06:00:00
      night_time_delay: 1
      time_delay: 1
      include_ambient: ambient_disabled
      ambient_light_sensor: sensor.balkon_motion_illuminance_safe
      ambient_light_options: ambient_light_option_disabled
      include_zone: zone_enabled
      zone: zone.home
      ambient_light_value: 150
      include_time: time_disabled
      after_time: 06:00:00
      before_time: '22:00:00'
      night_lights_conditions:
      - time_enabled
      night_lights_entity_state:
      - input_boolean.schlafenszeit
      include_sun: sun_enabled
      include_night_light_control:
      - use_brightness
      ambient_light_high_value: 200
      motion_bypass_lights_on: []
      motion_bypass_lights_off: []
      include_bypass:
      - bypass_enabled_stop
      motion_bypass_lights_stop:
      - binary_sensor.wohnzimmer_manual_control
